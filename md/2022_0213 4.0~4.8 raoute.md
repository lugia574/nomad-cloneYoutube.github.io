# 4 ROUTERS

## 4.0 What are Routers?

ë¼ìš°í„°ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì™€ URL ê´€ë¦¬ë¥¼ ì‰½ê²Œ í•´ì¤Œ

```
/ -> Home
/join -> Join
/login -> Login
/search -> Search

/user/edit -> Edit User
/user/delete -> Delete User

/video/watch -> Watch Video
/video/edit -> Edit Video
/video/delete -> Delete Video
/video/comments -> comment on a video
/video/comments/delete -> Delet A comment of a video

```

ì´ë ‡ê²Œ ë¼ìš°í„°ëŠ” ì‘ì—…ì¤‘ì¸ ì£¼ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ URLë¥¼ ê·¸ë£¹í™” í•´ì¤Œ

`/`, `/join` ê°™ì€ ê±¸ **Global Router(ê¸€ë¡œë²Œ ë¼ìš°í„°)** ë¼ê³  ë¶€ë¦„

<br>
<br>

## 4.1 Making Our Routers

ì‚¬ì‹¤ ì—„ë°€íˆ ë”°ì§€ë©´ `/join` ì€ ìœ ì €ê°€ íšŒì›ê°€ì… í•˜ëŠ” ê²ƒ ì´ë‹ˆê¹Œ

`/user/join` ê°€ ë…¼ë¦¬ìƒ ë§ìŒ

í•˜ì§€ë§Œ êµ¬ì¥ join ê°™ì€ ëª…í™•í•œê±°ëŠ” ì˜ˆì™¸ë¡œ ë‘¬ì„œ urlë¥¼ ê¹”ë”í•˜ê²Œ í•˜ëŠ” ê±°ì„

<br><br>

ì´ì œ ê¸€ë¡œë²Œ ë¼ìš°í„°ë¥¼ ë§Œë“¤ì–´ ë³¼êº¼ì„

```js
const globalRouter = express.Router();
```

ì¶”ê°€ë¡œ ìœ ì € ë¼ìš°í„°ì™€ ë¹„ë””ì˜¤ ë¼ìš°í„°ë„ ë§Œë“¤ì–´ ì¤Œ

```js
const globalRouter = express.Router();
const userRouter = express.Router();
const videoRouter = express.Router();

app.use("/", globalRouter);
app.use("/video", videoRouter);
app.use("/users", userRouter);
```

ì´ì œ ë¼ìš°í„°ë“¤ì— í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  ì ìš© ì‹œì¼œì•¼í•¨

```js
const app = express();
const logger = morgan("dev");
app.use(logger);

const globalRouter = express.Router();
const handleHome = (req, res) => res.send("Home");
globalRouter.get("/", handleHome);

const userRouter = express.Router();
const handleEditUser = (req, res) => res.send("Edit User");
userRouter.get("/edit", handleEditUser);

const videoRouter = express.Router();
const handleWatchVideo = (req, res) => res.send("Watch Video");
videoRouter.get("/watch", handleWatchVideo);

app.use("/", globalRouter);
app.use("/videos", videoRouter);
app.use("/users", userRouter);
```

<br>
<br>

## 4.2 Cleaning the Code

ì½”ë“œê°€ ì§€ì €ë¶„ í•˜ë‹ˆ ì •ë¦¬ ã„±ã„±

server.js

```js
import express from "express";
import morgan from "morgan";

import globalRouter from "./routers/globalRouter";
import videoRouter from "./routers/videoRouter";
import userRouter from "./routers/userRouter";

const PORT = 4000;

const app = express();
const logger = morgan("dev");
app.use(logger);

app.use("/", globalRouter);
app.use("/videos", videoRouter);
app.use("/users", userRouter);

const handleListening = () =>
  console.log(`âœ… Server listenting on port http://localhost:${PORT} ğŸš€`);

app.listen(PORT, handleListening);
```

globalRouter.js

```js
import express from "express";

const globalRouter = express.Router();
const handleHome = (req, res) => res.send("Home");

globalRouter.get("/", handleHome);

export default globalRouter;
```

videoRouter.js

```js
import express from "express";

const videoRouter = express.Router();
const handleWatchVideo = (req, res) => res.send("Watch Video");

videoRouter.get("/watch", handleWatchVideo);

export default videoRouter;
```

userRouter.js

```js
import express from "express";

const userRouter = express.Router();
const handleEditUser = (req, res) => res.send("Edit User");

userRouter.get("/edit", handleEditUser);

export default userRouter;
```

<br>
<br>

## 4.3 Exports

í•˜ì§€ë§Œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ê¸¸ì–´ì§€ë©´ ì´ ì—­ì‹œë„ ë³µì¡í•´ì§

ë¼ìš°í„°ë§Œ ë‚¨ê¸°ê³  ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë˜ ë¶„ë¦¬ í•´ì•¼í•¨

ê·¸ëŸ¬ë©´ ëŒ€ëµ

```js
import express from "express";
import join from "../controller/userController";
import trending from "./videoRouter";

const globalRouter = express.Router();

globalRouter.get("/", join);
globalRouter.get("/join", trending);

export default globalRouter;
```

```js
const join = (req, res) => res.send("join");

export default join;
```

ì´ëŸ°ì‹ìœ¼ë¡œ ê°€ëŠ¥í•¨

ê·¼ë° export defaultëŠ” í•˜ë‚˜ì”©ë§Œ ë¨

```js
import express from "express";

import { join } from "../controllers/userController";
import { trending } from "../controllers/videoController";

const globalRouter = express.Router();

globalRouter.get("/", trending);
globalRouter.get("/join", join);

export default globalRouter;
```

```js
export const join = (req, res) => res.send("Join");
export const edit = (req, res) => res.send("Edit User");
export const remove = (req, res) => res.send("Remove User");
```

ê·¸ë˜ì„œ ì´ë ‡ê²Œ í•¨

<br>
<br>

### â€» ì˜ë¬¸

ì´ëŸ´êº¼ë©´

ê·¸ëƒ¥ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì„ objectì— ë‹¤ ë•Œë ¤ ë°•ì•„ì„œ ê·¸ê±¸ export í•˜ë©´ ì•ˆë˜ëŠ”ê±¸ê¹Œ?

ì§€ê¸ˆ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ 2~3ê°œ ì •ë„ì—¬ì„œ ê·¸ë ‡ì§€

ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë§ì•„ì§€ë©´

```js
import { trending, 11111, 2222, 3333, 4444, 5555, 6666, 7777,8888, ~~~~~~ } from "../controllers/videoController";

```

ì´ë ‡ê²Œ ë í…ë°?

ê·¸ëŸ¼ ì ˆëŒ€ë¡œ ì¢‹ì€ ì½”ë“œê°€ ì•„ë‹í…ë° ë§ì´ë‹¤

> ì°¾ì•„ë³´ë‹ˆê¹Œ ê·¸ë ‡ê²Œ í•˜ëŠ”ê±° ê°™ë‹¤ <br>
> ì˜¤ë¸Œì íŠ¸ë¡œ í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì„œ í•¨ <br>
> ê·¸ëŸ¬ë„¤ ë‚˜ ì˜›ë‚ ì— í–ˆì„ë•Œë„ í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì„œ ê·¸ê±° ê°€ì ¸ë‹¤ ì“°ê³  ê·¸ë«ì–´

<br>
<br>

## 4.4~ 4.5 ëŠ” ë³µìŠµ

ìƒëµ

<br>
<br>

## 4.6 Planning Routes

ì»¨íŠ¸ë¡¤ëŸ¬ ì¶”ê°€í•¨

globalRouter.js

```js
import express from "express";

import { join, login } from "../controllers/userController";
import { trending, search } from "../controllers/videoController";

const globalRouter = express.Router();

globalRouter.get("/", trending);
globalRouter.get("/join", join);
globalRouter.get("/login", login);
globalRouter.get("/search", search);

export default globalRouter;
```

userRouter.js

```js
import express from "express";
import { edit, remove, logout, see } from "../controllers/userController";

const userRouter = express.Router();

userRouter.get("/logout", logout);
userRouter.get("/edit", edit);
userRouter.get("/remove", remove);
userRouter.get("/:id", see);

export default userRouter;
```

videoRouter.js

```js
import express from "express";
import { see, edit, upload, deleteVideo } from "../controllers/videoController";

const videoRouter = express.Router();

videoRouter.get("/upload", upload);
videoRouter.get("/:id", see);
videoRouter.get("/:id/edit", edit);
videoRouter.get("/:id/delete", deleteVideo);

export default videoRouter;
```

## 4.7 URL Parameters part One

`/:id` ì— ëŒ€í•´ ì•Œì•„ ë³¼êº¼ì„

    URL ì— ë³€ìˆ˜ë¥¼ í¬í•¨ ì‹œí‚¤ëŠ” ê±°

videosController.js ì—

```js
export const see = (req, res) => {
  console.log(req.params);
  return res.send("Watch");
};
```

see ë¥¼ ì´ë ‡ê²Œ ë°”ê¾¸ê³ 

`http://localhost:4000/videos/1231231` ë¡œ ì…ë ¥í•˜ë©´

ì½˜ì†”ì°½ì—

```
{ id: '1231231' }
GET /videos/1231231 304 1.710 ms - -
```

ì´ë ‡ê²Œ ë‚˜ì˜´

express ëŠ” request íŒŒë¼ë¯¸í„°ë¥¼ ì´í•´í•  ìˆ˜ ìˆìŒ

`http://localhost:4000/videos/1231231/edit`
`http://localhost:4000/videos/1231231/delete`

í•´ë„ ê°’ ë°›ê¸° ìŒ‰ ê°€ëŠ¥

### â€» ì£¼ì˜ì 

1.  **ë¬´ì¡°ê±´** `:` ë¥¼ ì¨ì•¼í•¨
2.  `:/id` ë“¤ì€ ë§¨ ì•„ë˜ë¡œ ë‚´ë¦´ ê²ƒ.

        videoRouter.get("/:id", see);
        videoRouter.get("/upload", upload);
        videoRouter.get("/:id/edit", edit);
        videoRouter.get("/:id/delete", deleteVideo);

        ì´ë ‡ê²Œ í•œë‹¤ë©´ /upload ë¥¼ express ê°€ idë¡œ ì¸ì‹ í•´ë²„ë¦¼

2 ë²ˆì„ í•´ê²° í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

id ê°’ì´ ìˆ«ìì—¬ì•¼ í•œë‹¤ê³  ì „ë‹¬ í•  ìˆ˜ ìˆìŒ ë¨

ê·¸ê±¸ ì´ì œ ë°°ì›Œ ë³´ì.

<br>
<br>

## 4.8 URL Parameters part Two

ìš°ì„  express ë¼ìš°íŒ…(`ì •ê·œì‹`)ì— ëŒ€í•´ ì•Œì•„ë³´ì

`*` ëª¨ë“ ê±¸ ëœ»í•¨

```js
app.get("/ab*cd", functionName);
```

abcd, ab12cd, abxcd, abRANDOMcd ë„ ì‘ë™í•œë‹¤ëŠ” ì†Œë¦¬ì„

<br>
<br>

`+` ëŠ” ì•ì˜ ë¬¸ìê°€ ë³µìˆ˜

```js
app.get("/ab+cd", functionName);
```

abcd, abbcd, abbbbbbbcd ë„ ì‘ë™í•¨

```js
app.get("/ab(\\w+)", functionName);
```

`\w+` ëª¨ë“  ë¬¸ì, ìˆ«ì ì„ íƒ

ab, abdw, abcd, abcdef, ad12312511 ~~~

```js
app.get("(\\d+)", functionName);
```

`\d+` ì´ê±°ëŠ” ìˆ«ìë§Œ

<br>
<br>

`?` ëŠ” ì„ íƒì‚¬í•­

```js
app.get("/ab?cd", functionName);
```

abcd, acd ë„ ì‘ë™í•¨

bê°€ ìˆì–´ë„ ë˜ê³  ì—†ì–´ë„ ë˜ê³ 

```js
app.get("/ab(cd)?e", functionName);
```

ì´ëŸ¬ë©´ abe, abcde ì´ë ‡ê²Œ ë¨

<br>
<br>

ìš°ë¦¬ ì‹¤ìŠµì—ì„œëŠ” ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´í˜•ì‹ì´ë‘ ë‹¬ë¼ì„œ

ë­ ì–´ë–»ê²Œ ì‡¼ë¶€ë¥¼ ì¹œë‹¤ëŠ”ë°

ìš°ì„  express ì—ì„œë„ ì´ë ‡ê²Œ ê°€ëŠ¥í•˜ë‹¤~ ë­ ì´ëŸ° ì†Œë¦¬í•¨

ì•„ë¬´íŠ¼ ì´ê±¸ ì ìš© í•˜ë©´

```js
videoRouter.get("/:id(\\d+)", see);
```

ì´ë ‡ê²Œ ì ìš© í•˜ë©´ ëœë‹¤~

ê·¼ë° ì´ ì •ê·œì‹ ì•ˆì“¸êº¼ë˜ ë‹¤ë¥¸ íŒ¨í„´ì„ ì“¸êº¼ë˜ ì•Œê³ ë§Œ ìˆìœ¼ë€ë‹¤

ì°¸ë‚´~

[Express ì •ê·œì‹ ì°¸ê³  ì‹¸ì´íŠ¸](https://expressjs.com/en/guide/routing.html)

[Express ì •ê·œì‹ ì°¸ê³  ì‹¸ì´íŠ¸2](https://kasterra.github.io/regex1-the-basic-operation/)

[ì •ê·œí‘œí˜„ì‹ í…ŒìŠ¤íŠ¸ ì‚¬ì´íŠ¸](https://www.regexpal.com)
